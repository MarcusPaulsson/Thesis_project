import random

class TwentyFourPointGame:
    """
    This is a game of twenty-four points, which provides to generate four numbers and check whether player's expression is equal to 24.
    """

    def __init__(self) -> None:
        """
        Initializes the game with an empty list of numbers.
        """
        self.nums = []


    def _generate_cards(self):
        """
        Generates four random numbers between 1 and 9 (inclusive) and stores them in the `nums` attribute.
        """
        self.nums = [random.randint(1, 9) for _ in range(4)]


    def get_my_cards(self):
        """
        Generates a new set of cards and returns them.
        :return: list of integers, representing the player's cards
        """
        self._generate_cards()
        return self.nums


    def answer(self, expression):
        """
        Checks if a given mathematical expression evaluates to 24, using the current set of cards (if available).
        If `self.nums` is empty, it returns a predefined list ['p', 'a', 's', 's'].
        :param expression: string, mathematical expression using the cards
        :return: bool, True if the expression evaluates to 24, False otherwise, or a list if self.nums is empty.
        """
        if not self.nums:
            return ['p', 'a', 's', 's']
        return self._evaluate(expression)


    def evaluate_expression(self, expression):
        """
        Evaluates a mathematical expression and checks if the result is 24. This method does not depend on the cards generated by the game.
        :param expression: string, mathematical expression
        :return: bool, True if the expression evaluates to 24, False otherwise
        """
        return self._evaluate(expression)


    def _evaluate(self, expression):
        """
        Helper function to evaluate a mathematical expression and check if the result is close to 24.
        Handles potential errors during evaluation.
        :param expression: string, mathematical expression
        :return: bool, True if the expression evaluates to 24, False otherwise
        """
        try:
            result = eval(expression)
            return abs(result - 24) < 1e-6  # Using a small tolerance for floating-point comparisons
        except (SyntaxError, NameError, TypeError, ZeroDivisionError):
            return False